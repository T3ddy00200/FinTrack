<UserControl x:Class="FinTrack.Controls.MessagesPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{DynamicResource BackgroundBrush}"
             HorizontalAlignment="Stretch"
             VerticalAlignment="Stretch">

    <Grid Margin="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Верхняя панель: Ручная отправка уведомлений -->
        <Expander Header="Ручная отправка уведомлений"
                  ExpandDirection="Down"
                  Margin="20,10"
                  Foreground="{DynamicResource TextBrush}"
                  Background="{DynamicResource PanelBackgroundBrush}"
                  FontWeight="Bold"
                  FontSize="16"
                  HorizontalAlignment="Stretch">
            <StackPanel Margin="10" HorizontalAlignment="Stretch">
                <TextBlock Text="Email отправителя:"/>
                <TextBox x:Name="SenderEmailBox" Margin="0,5" HorizontalAlignment="Stretch"/>

                <TextBlock Text="Пароль для отправки:"/>
                <PasswordBox x:Name="SenderPasswordBox" Margin="0,5" HorizontalAlignment="Stretch"/>

                <TextBlock Text="Пароль для чтения:"/>
                <PasswordBox x:Name="ReadPasswordBox" Margin="0,5" HorizontalAlignment="Stretch"/>

                <Button Content="Сохранить настройки"
                        Click="SaveSettingsButton_Click"
                        Height="35"
                        Margin="0,10,0,10"
                        Background="{DynamicResource AccentBrush}"
                        Foreground="White"
                        BorderBrush="{x:Null}"
                        HorizontalAlignment="Left"/>

                <TextBlock Text="Текст уведомления:"/>
                <TextBox x:Name="MessageTextBox"
                         Height="80"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         Margin="0,5"
                         HorizontalAlignment="Stretch"/>

                <TextBlock Text="Выберите получателей:" Margin="10,10,0,5"/>
                <ListBox x:Name="RecipientsListBox"
                         Height="120"
                         SelectionMode="Extended"
                         HorizontalAlignment="Stretch"/>

                <DockPanel Margin="0,10,0,0">
                    <Button Content="Выбрать PDF"
                            Click="ChoosePdf_Click"
                            Width="140"
                            Background="{DynamicResource AccentBrush}"
                            Foreground="White"
                            BorderBrush="{x:Null}"
                            DockPanel.Dock="Left"/>
                    <TextBlock x:Name="NotificationPdfFileNameTextBlock"
                               Text="(файл не выбран)"
                               Margin="10,0,0,0"
                               VerticalAlignment="Center"
                               Foreground="{DynamicResource SubTextBrush}"/>
                </DockPanel>

                <Button Content="Отправить уведомление"
                        Click="SendNotification_Click"
                        Height="40"
                        Margin="0,10,0,0"
                        Background="{DynamicResource AccentBrush}"
                        Foreground="White"
                        BorderBrush="{x:Null}"
                        HorizontalAlignment="Left"/>
            </StackPanel>
        </Expander>

        <!-- Основная часть: входящие письма и ответы -->
        <Grid Grid.Row="1" Margin="20" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="0" Margin="0,0,0,10" HorizontalAlignment="Stretch">
                <TextBlock Text="Входящие сообщения"
                           FontSize="24"
                           FontWeight="Bold"
                           Foreground="{DynamicResource TextBrush}" />
                <TextBlock x:Name="StatusTextBlock"
                           FontSize="14"
                           Foreground="{DynamicResource DangerBrush}"
                           Margin="0,5,0,0"/>
            </StackPanel>

            <ListBox x:Name="MessagesListBox"
                     Grid.Row="1"
                     Background="{DynamicResource PanelBackgroundBrush}"
                     Foreground="{DynamicResource TextBrush}"
                     BorderBrush="{DynamicResource BorderBrush}"
                     BorderThickness="1"
                     SelectionChanged="MessagesListBox_SelectionChanged"
                     HorizontalAlignment="Stretch"
                     VerticalAlignment="Stretch"/>

            <Grid Grid.Row="2" Margin="0,20,0,0" HorizontalAlignment="Stretch">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBox x:Name="ReplyTextBox"
                         Grid.Row="0"
                         Height="80"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         Background="{DynamicResource PanelBackgroundBrush}"
                         Foreground="{DynamicResource TextBrush}"
                         BorderBrush="{DynamicResource BorderBrush}"
                         BorderThickness="1"
                         HorizontalAlignment="Stretch"/>

                <DockPanel Grid.Row="1" Margin="0,5,0,5">
                    <Button Content="Выбрать PDF"
                            Click="ChoosePdf_Click"
                            Width="120"
                            Background="{DynamicResource AccentBrush}"
                            Foreground="White"
                            BorderBrush="{x:Null}"
                            DockPanel.Dock="Left"/>
                    <TextBlock x:Name="ReplyPdfFileNameTextBlock"
                               Text="(файл не выбран)"
                               Margin="10,0,0,0"
                               VerticalAlignment="Center"
                               Foreground="{DynamicResource SubTextBrush}"/>
                </DockPanel>

                <Button Grid.Row="2"
                        Content="Ответить"
                        Click="ReplyButton_Click"
                        Width="120"
                        Height="40"
                        Background="{DynamicResource AccentBrush}"
                        Foreground="White"
                        BorderBrush="{x:Null}"
                        HorizontalAlignment="Left"/>
            </Grid>
        </Grid>

        <!-- Экран загрузки -->
        <Border x:Name="LoadingOverlay"
                Background="#99000000"
                CornerRadius="6"
                Visibility="Collapsed">
            <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <TextBlock Text="Загрузка писем..."
                           Foreground="White"
                           FontSize="20"
                           FontWeight="Bold"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>